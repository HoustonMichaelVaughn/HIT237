{% extends "mango_pests/base.html" %}
{% block content %}

  <!-- I’m wrapping the pest checks in a card for a cleaner look -->
  <div class="card mb-4">
    <div class="card-header">
      <h5 class="mb-0">Pest Records</h5>
    </div>
    <div class="card-body p-0">
      {% if user.is_authenticated %}
        <!-- I’m adding a bigger Add button right above the table -->
        <div class="p-3">
          <a href="{% url 'pestcheck_create' %}" class="btn btn-primary">Add New Pest Record</a>
        </div>
      {% endif %}
      
      <!-- I’m using a striped, hoverable table for readability -->
      <table class="table table-striped table-hover mb-0">
        <thead class="table-light">
          <tr>
            <th>Date</th>
            <th>Block</th>
            <th>Pest</th>
            <th># Inspected</th>
            <th># Positives</th>
            <th>Confidence</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for record in pestcheck_list %}
          <tr>
            <td>{{ record.date_checked }}</td>
            <td>{{ record.farm_block.name }}</td>
            <td>{{ record.pest.name }}</td>
            <td>{{ record.num_trees }}</td>
            <td>{{ record.positives }}</td>
            <td>
              <!-- I’m showing confidence with colored badges -->
              {% if record.confidence >= 0.9 %}
                <span class="badge bg-success">{{ record.confidence|floatformat:2 }}</span>
              {% elif record.positives > 0 %}
                <span class="badge bg-danger">Pest Found</span>
              {% else %}
                <span class="badge bg-warning text-dark">{{ record.confidence|floatformat:2 }}</span>
              {% endif %}
            </td>
            <td>
              <!-- I’m using small outline buttons for Edit/Delete -->
              <a href="{% url 'pestcheck_edit' record.pk %}" class="btn btn-sm btn-outline-primary me-2">Edit</a>
              <a href="{% url 'pestcheck_delete' record.pk %}" class="btn btn-sm btn-outline-danger">Delete</a>
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="7" class="text-center py-3">No pest records found.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

{% endblock %}
